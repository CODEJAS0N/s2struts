<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- don't edit start -->
<head><title>Seasar - DI Container with AOP - </title><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta http-equiv="Content-Style-Type" content="text/css">
<link href="seasar_b.css" type="text/css" rel="stylesheet" media="screen"><script src="seasar_b.js" type="text/JavaScript" language="JavaScript"></script>
</head><body onload="preload('en')">
<table width="100%" border="0" cellspacing="0" cellpadding="0" align="left"><tr>
<td align="left" valign="top" width="780"><table width="780" border="0" cellspacing="0" cellpadding="0" class="white">
<tr><td colspan="7"><img height="5" width="780" src="images/top01_b.gif" alt=""></td></tr>
<tr><td><img height="117" width="235" src="images/top02_b.gif" alt="Seasar"></td>
<td colspan="3"><img height="117" width="289" src="images/top03.gif" alt="DI Container with AOP"></td>
<td colspan="3"><img height="117" width="256" src="images/spacer.gif" alt=""></td>
</tr><tr><td rowspan="2"><img src="images/top04.gif" alt="" height="49" width="235"></td>
<td><a href="http://www.seasar.org/en/index.html"><img src="images/menu01_b_en.gif" height="30" width="78" border="0" alt="" id="menu01" onmouseover="swap(1)" onmouseout="restore(1)"></a></td>
<td><a href="http://www.seasar.org/en/projects.html"><img src="images/menu02_b_en.gif" height="30" width="101" border="0" alt="" id="menu02" onmouseover="swap(2)" onmouseout="restore(2)"></a></td>
<td><a href="http://www.seasar.org/en/products.html"><img src="images/menu06_b_en.gif" height="30" width="110" border="0" alt="" id="menu06" onmouseover="swap(6)" onmouseout="restore(6)"></a></td>
<td><a href="http://www.seasar.org/en/documents.html"><img src="images/menu04_b_en.gif" height="30" width="109" border="0" alt="" id="menu04" onmouseover="swap(4)" onmouseout="restore(4)"></a></td>
<td><a href="http://www.seasar.org/en/resources.html"><img src="images/menu05_b_en.gif" height="30" width="113" border="0" alt="" id="menu05" onmouseover="swap(5)" onmouseout="restore(5)"></a></td>
<!--
<td><img src="images/menu07_b_en.gif" height="30" width="109" border="0" alt=""  id="menu07" onmouseover="swap(7)" onmouseout="restore(7)"></td>
//-->
<td><img height="30" width="34" src="images/menu06.gif" alt=""></td></tr><tr>

<td colspan="6"><img height="19" width="545" src="images/spacer.gif" alt=""></td></tr></table>
<table  width="780" border="0" cellspacing="0" cellpadding="0" class="white">
<tr align="left" valign="top"><td width="14"><img height="14" width="14" src="images/spacer.gif" alt=""></td><td width="740" class="main">
<!-- don't edit end -->
<!-- document start -->
	<!-- Index -->
<ul>
	<li><a href="#Outline">S2StrutsUnit Outline</a></li>
	<li><a href="#Reference">S2StrutsUnit Reference</a></li>
	<ul>
		<li><a href="#S2StrutsUnitMake">Creating Test classes using S2StrutsUnit</a></li>
		<li><a href="#S2StrutsUnitFunction">S2StrutsUnit Functionality</a></li>
	</ul>
	<li><a href="#Example">Example</a></li>
	<ul>
		<li><a href="#BasicExample">Basic testing of the Action class</a></li>
		<li><a href="#ActionFormExample">Testing the Action class using ActionForm</a></li>
		<li><a href="#MappingDispatchActionExample">Testing the MappingDispatchAction class</a></li>
		<li><a href="#LoadWebContextTestExample">Testing using Context Read-in</a></li>
	</ul>
</ul>
	<!-- Outline -->
	<h2><a name=Outline>S2StrutsUnit Outline</a></h2>
    <p>
	S2StrutsUnit has the following characteristics.
	</p>
	<ul>
		<li>UnitTest functionality using ServletAPI</li>
		<p>
		As with S2Unit, testing is possible through the use of mock ServletAPI objects.
		The difference between S2Unit is the ability to define a return value from ServletAPI in the component definition file.
		</p>
		<li>Testing functionality of the Action subclass of Struts</li>
		<p>
		Testing the Action class is very easy.
		Various tests are done simply by passing the required parameters as method arguments.
		These include the Request value reference testing, ActionForm referencing testing, MappingDispatchAction testing, and testing in a requested path.
		</p>
	</ul>

    <!-- Reference -->
	<h2><a name=Reference>S2StrutsUnit Reference</a></h2>
	<h3><a name=S2StrutsUnitMake>Creating Test classes using S2StrutsUnit</a></h3>
	<p>
	Test classes are created by inheriting org.seasar.struts.unit.S2StrutsTestCase .
	S2StrutsTestCase is an expansion of the S2TestCase class, and uses the same test methods as S2TestCase and JUnit.
	</p>
	<h3><a name=S2StrutsUnitFunction>S2StrutsUnit Functionality</a></h3>
	<p>
	S2StrutsUnit contains the following functionality to make S2Struts development testing easier.
	</p>
	<dl>
   		<dt style="text-indent:1em;"><b>Execute Action with a selected Action</b></dt>
   		<dd>Pass the instance of Action as an argument to S2StrutsTestCase#execute(Action) to run an Action class with injected services.</dd>
   		<dd>The S2StrutsTestCase#execute(Class) method provides identical functionality without creating an instance of the Action class.</dd>
		<dd>The resulting return value will be the forward name of the ActionMapping returned by Action.</dd>
   	</dl>
	<dl>
   		<dt style="text-indent:1em;"><b>Execute Action with a selected Action and ActionForm</b></dt>
   		<dd>Pass the instance of Action and ActionForm as arguments to S2StrutsTestCase#execute(Action,ActionForm) to run an Action class with services injected.</dd>
   		<dd>The S2StrutsTestCase#execute(Class, ActionForm) method provides identical functionality without creating an instance of the Action class.</dd>
		<dd>The resulting return value will be the forward name of the ActionMapping returned by Action.</dd>
   	</dl>
	<dl>
   		<dt style="text-indent:1em;"><b>Execute MappingDispatchAction</b></dt>
   		<dd>Pass the instance of Action,  ActionForm, and method name as arguments to S2StrutsTestCase#execute(Action, ActionForm,String) to run an Action class with services injected. The S2StrutsTestCase#execute(Action,String) method can be used without an ActionForm.</dd>
   		<dd>The S2StrutsTestCase#execute(Class,ActionForm,String) method provides identical functionality without creating an instance of the Action class. The S2StrutsTestCase#execute(Class,String) method can also be used.</dd>
		<dd>The resulting return value will be the forward name of the ActionMapping returned by Action.</dd>
   	</dl>
	<dl>
   		<dt style="text-indent:1em;"><b>Execute Action using a selected path</b></dt>
   		<dd>Pass the selected path name as an argument to the  S2StrutsTestCase#execute(String) method to create and run a corresponding Action class with services injected.</dd>
		<dd>The resulting return value will be the forward name of the ActionMapping returned by Action.</dd>
		<dd>When running an Action class by selecting a path, context read-in as described below is required.</dd>
   	</dl>
	<dl>
   		<dt style="text-indent:1em;"><b>Context Read-in</b></dt>
   		<dd>The setDocBase(String) method is used to read-in values from struts-config.xml in the selected path. The WEB-INF directory must exist directly within the selected directory.</dd>
		<dd>The arguments path is searched from the selected resources. As with S2TestCase#include(String), either the full path or relative path from the test class can both be used to select a path.</dd>
   	</dl>


    <!--  Example  -->
	<h2><a name=Example>Example</a></h2>

	<h3><a name="BasicExample">Basic testing of the Action class</a></h3>
    <ul>
		<li type="circle">Inherit S2StrutsTestCase.</li>
		<li type="circle">Include s2struts.dicon and the component definition file with the HttpServletAPI mock definitions using setUp().</li>
		<li type="circle">Include the definition of the Action and Service components from the definition file using setUpExecuteTrue().</li>
		<li type="circle">Run TestAction using execute(TestAction.class) of testExecuteTrue().</li>
		<li type="circle">Test the Forward target using the execute method return value, ActionMessages using getActionMessages(), and ActionErrors using getActionErrors().</li>
    </ul>

	<pre>
public class TestActionTest extends S2StrutsTestCase {

    public TestActionTest(String name) {
        super(name);
    }

    protected void setUp() {
        include("HttpMockObject.dicon");
        include("s2struts.dicon");
    }

    public void setUpExecuteTrue() {
        include("TestServiceReturnTrue.dicon");
    }

    public void testExecuteTrue() throws Exception {
        String actual = execute(TestAction.class);

        assertEquals("success", actual);

        String[] values = {"val1", "val2", "val3", "val4", "val5"};
        ActionMessages expectedMessages = new ActionMessages();
        expectedMessages.add("message", new ActionMessage("messageKey", values));
        assertEquals(expectedMessages, getActionMessages());
    }
}
	</pre>

	<h3><a name="ActionFormExample">Testing the Action class using ActionForm</a></h3>
    <ul>
		<li type="circle">Create an instance of ActionForm, and run the Action after configuring the instance with the test values.</li>
    </ul>

	<pre>
public class FormTestActionTest extends S2StrutsTestCase {

    ...

    public void testGetValueFromForm() throws Exception {
        TestActionForm form = new TestActionForm();
        form.setVal("foo");

        String actual = execute(FormTestAction.class, form);

        assertEquals("foo", actual);
    }
}
	</pre>

	<h3><a name="MappingDispatchActionExample">Testing the MappingDispatchAction class</a></h3>
    <ul>
		<li type="circle">Pass the variable "foo" as the argument of the execute method to test the method foo(ActionMapping, ActionForm, HttpServletRequest, HttpServletResponse).</li>
    </ul>

	<pre>
public class MappingDispatchActionTest extends S2StrutsTestCase {

    ...

    public void testFooMethod() throws Exception {
        String actual = execute(DispatchTestAction.class, "foo");
        assertEquals("success", actual);
    }
}
	</pre>

	<h3><a name="LoadWebContextTestExample">Testing using Context Read-in</a></h3>
    <ul>
		<li type="circle">Select a directory containing context files using setDocBase(String) in setUp().</li>
		<li type="circle">Instances of Action actually run can be acquired using getExecutedAction().</li>
		<li type="circle">Instances of ActionForm actually run can be acquired using getExecutedActionForm().</li>
    </ul>

	<pre>
public class LoadWebContextTest extends S2StrutsTestCase {

    ....

    protected void setUp() {
        ...
        setDocBase("org/seasar/struts/unit");
    }

    public void testExecuteString() throws Exception {
        String actual = execute("/login?id=id&amp;pass=pass");

        assertEquals("success", actual);
        assertEquals(LoginAction.class, getExecutedAction().getClass());
        assertNull(getExecutedActionForm());
    }
}
	</pre>

<!-- document end -->
<!-- don't edit start -->
</td>
<td width="14"><img height="14" width="14" src="images/spacer.gif" alt=""></td>
</tr><tr>
<td width="14"><img height="30" width="14" src="images/spacer.gif" alt=""></td>
<td width="766"><img height="30" width="592" src="images/spacer.gif" alt=""></td>
</tr><tr>
<td width="14"><img height="14" width="14" src="images/spacer.gif" alt=""></td>
<td width="766" class="copyright">Copyright&copy; 2004-2005, The Seasar Foundation and the others. All rights reserved.</td>
</tr></table>
<td class="backright" align="left" valign="top">&nbsp;</td></tr><tr>
<td class="backunder" align="left"  valign="top" width="780" height="16">&nbsp;</td>
<td class="backcorner" align="left" valign="top" height="16">&nbsp;</td>
</tr></table></body>
<!-- don't edit end -->
</html>
